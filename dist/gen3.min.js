"use strict";
/**
 * Gen3: A utility for managing and computing interdependent values within a tree.
 *
 * @copyright 2023 Claus Nuoskanen
 * @author Claus Nuoskanen <claus.nuoskanen@gmail.com>
 * @license MIT
 */class Gen3{fnMap=new Map;define(key,fn,dependencies){if(this.fnMap.has(key))throw new Error(`"${key}" is already defined!`);dependencies?.forEach((dependency=>{if(!this.fnMap.has(dependency))throw new Error(`Dependency "${dependency}" has not been defined yet!`)}));this.fnMap.set(key,dependencies?this.wrapWithDependencies(fn,dependencies):fn);return this}get(key,param){const fn=this.fnMap.get(key);if(!fn)throw new Error(`ComputeFunction "${key}" is not defined!`);param.parent=param.parent??{};if(param.parent[key])return param.parent[key];param.parent[key]=fn(param);return param.parent[key]}wrapWithDependencies(fn,dependencies){return param=>fn({...param,parent:this.getParentValues(dependencies,param)})}getParentValues(dependencies,param){return dependencies.reduce(((acc,name)=>{acc[name]=this.get(name,param);return acc}),{})}}module.exports=Gen3;